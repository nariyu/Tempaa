(function(){"use strict";var e,a;e=function(){function e(){}return e.selectorTypes=["foreach","text","html","class","style","attr","visible","data","event"],e.bind=function(a,t){var n,r,o,l,d,i,s,c,u;for(r=$(a),o=this.helper,null==o&&(o=this),l=this.renderProperties,this.destroy(a),r.data("data",t),this.pre&&this.pre.apply(this,[r,t]),t?r.attr("data-bind-has-data","true"):r.removeAttr("data-bind-has-data"),s=[],i=this.selectorTypes,c=0,u=i.length;u>c;c++)d=i[c],s.push("[data-bind-"+d+"]");return(n=function(){var a,c;return a=r.find(s.join(",")),r.is(s.join(","))&&(a=$([r].concat(a.get()))),c=[],a.each(function(e,a){var t,n,o;return t=$(a),n=t.parent().closest("[data-bind-foreach]").get(),c=r.find("[data-bind-foreach]").get(),o=[],$.each(c,function(e,a){return $.each(n,function(e,t){return a===t?o.push(t):void 0})}),n=$(o),n.length>0&&c.push(a),n.each(function(e,a){var t,n,r,o;return t=$(a),n=t.data("bind-foreach-template"),n||(r=t.attr("data-bind-template-selector"),"string"==typeof r?(n=$(r),o=n.data("bind-foreach-template"),o&&(n=o)):n=t.children(),t.data("bind-foreach-template",n)),t.empty()})}),a=r.find(s.join(",")),r.is(s.join(","))&&(a=$([r].concat(a.get()))),a.each(function(a,s){var c,u,f,p,h,b,v,y,m,g,x,j,k,w,A,L,O,T,C,P,q,z,F,Z,B;for(c=$(s),O=[],P=0,F=i.length;F>P;P++)d=i[P],c.is("[data-bind-"+d+"]")&&(g=c.attr("data-bind-"+d),O.push({type:d,source:g}));for(q=0,Z=O.length;Z>q;q++)switch(L=O[q],A=L.type,g=L.source,A=A.replace(/^\s+/,"").replace(/\s+$/,""),g=g.replace("&lt;","<").replace("&gt;",">").replace("&quot;",'"').replace("&amp;","&"),g=g?g.replace(/^\s+/,"").replace(/\s+$/,""):"this",g=g.replace(/(@|\$data)([a-zA-Z])/g,"data.$2"),g=g.replace(/(@|\$data)/g,"data"),A){case"foreach":if(g&&"data"!==g?(C=l("{value:"+g+"}",t,o),C=C.value):C=t,k=c.data("bind-foreach-template"),c.empty(),C&&($.isArray(C)||"number"==typeof C.length&&"function"==typeof C.push))for(Array.observe&&(Array.observe(C,n),f=r.data("bind-destroy-funcs"),null==f&&(f=[]),f.push(function(){return Array.unobserve(C,n)}),r.data("bind-destroy-funcs",f)),z=0,B=C.length;B>z;z++)h=C[z],w=k.clone(!0),c.append(w),e.bind(w,h);break;case"text":if(null==t)return;C=null,g&&"data"!==g?(C=l("{value:"+g+"}",t,o),C=C.value):C=t,null==C&&(C=""),m=c.text(),m!==C&&c.text(C);break;case"html":if(null==t)return;C=null,g&&"data"!==g?(C=l("{value:"+g+"}",t,o),C=C.value):C=t,null==C&&(C=""),m=c.text(),m!==C&&c.html(C);break;case"class":u=l(g,t,o);for(b in u)C=u[b],C?c.addClass(b):c.removeClass(b);break;case"style":j=l(g,t,o);for(b in j)x=j[b],y=c.css(b),T=x.replace(/url\(\/(.+)\)/,"url("+location.origin+"$1)"),x!==y&&T!==y&&c.css(b,x);break;case"attr":c.attr(l(g,t,o));break;case"visible":C=null,g&&"data"!==g?(C=l("{value:"+g+"}",t,o),C=C.value):C=t,null==C&&(C=!1),C?c.attr("style",(""+c.attr("style")).replace(/display:([^;]+)/,"")):c.hide();break;case"data":C=null,g&&"data"!==g?(C=l("{value:"+g+"}",t,o),C=C.value):C=t,c.data("data",C);break;case"event":p=l(g,t,o);for(v in p)C=p[v],c.off(""+v+".tempaa"),c.on(""+v+".tempaa",$.proxy(C,t))}})})(),t&&("function"==typeof t.addListener?(t.addListener("change",n),r.data("bind-func",n)):"function"==typeof t.on?(t.on("change",n),r.data("bind-func",n)):Object.observe&&(Object.observe(t,n),r.data("bind-func",n))),r},e.destroy=function(e){var a,t,n,r,o,l,d;if(r=$(e),o=r.data("data"),a=r.data("bind-func"),o&&a&&("function"==typeof o.removeListener?o.removeListener("change",a):"function"==typeof o.off?o.off("change",a):Object.unobserve&&Object.unobserve(o,a)),n=r.data("bind-destroy-funcs"))for(l=0,d=n.length;d>l;l++)(t=n[l])();return r.data("data",null),r.data("bind-func",null),r.data("bind-destroy-funcs",null)},e.renderProperties=function(e,a,t){var n,r,o,l,d;if(null==a)return{};l='if (typeof data === "undefined" || data === null) { data = {}; }';for(r in t)l+="var "+r+' = helper["'+r+'"];';for(r in a)d=a[r],l+="function"==typeof d?"var "+r+' = $.proxy(data["'+r+'"], data);':"var "+r+' = data["'+r+'"];';l+="return "+e;try{return o=new Function("data","$","context","helper",l),o.call(this,a,$,a,t)}catch(i){if(n=i,console.error("[Tempaa] render properties error: ",n.message),console.log(a),console.log(l),n.message.match(/is not defined/))for(r in a)d=a[r],"function"!=typeof d&&console.log(r,d);return{}}},e}(),("undefined"!=typeof module&&null!==module?module.exports:void 0)?module.exports=e:"undefined"!=typeof a&&null!==a?a=e:"undefined"!=typeof window&&null!==window&&(window.Tempaa=e)}).call(this);