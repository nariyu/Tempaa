(function(){"use strict";var e,a;e=function(){function e(){}return e.selectorTypes=["foreach","text","html","class","style","attr","prop","visible","data","event"],e.bind=function(a,t){var n,r,o,l,d,i,c,s,u;for(r=$(a),o=this.helper,null==o&&(o=this),l=this.renderProperties,this.destroy(a),r.data("data",t),this.pre&&this.pre.apply(this,[r,t]),t?r.attr("data-bind-has-data","true"):r.removeAttr("data-bind-has-data"),c=[],i=this.selectorTypes,s=0,u=i.length;u>s;s++)d=i[s],c.push("[data-bind-"+d+"]");return(n=function(){var a,s;return a=r.find(c.join(",")),r.is(c.join(","))&&(a=$([r].concat(a.get()))),s=[],a.each(function(e,a){var t,n,o;return t=$(a),n=t.parent().closest("[data-bind-foreach]").get(),s=r.find("[data-bind-foreach]").get(),o=[],$.each(s,function(e,a){return $.each(n,function(e,t){return a===t?o.push(t):void 0})}),n=$(o),n.length>0&&s.push(a),n.each(function(e,a){var t,n,r,o;return t=$(a),n=t.data("bind-foreach-template"),n||(r=t.attr("data-bind-template-selector"),"string"==typeof r?(n=$(r),o=n.data("bind-foreach-template"),o&&(n=o)):n=t.children(),t.data("bind-foreach-template",n)),t.empty()})}),a=r.find(c.join(",")),r.is(c.join(","))&&(a=$([r].concat(a.get()))),a.each(function(a,c){var s,u,f,p,h,b,v,y,m,g,x,k,j,w,A,L,O,T,C,P,q,z,F,Z,B;for(s=$(c),O=[],P=0,F=i.length;F>P;P++)d=i[P],s.is("[data-bind-"+d+"]")&&(g=s.attr("data-bind-"+d),O.push({type:d,source:g}));for(q=0,Z=O.length;Z>q;q++)switch(L=O[q],A=L.type,g=L.source,A=A.replace(/^\s+/,"").replace(/\s+$/,""),g=g.replace("&lt;","<").replace("&gt;",">").replace("&quot;",'"').replace("&amp;","&"),g=g?g.replace(/^\s+/,"").replace(/\s+$/,""):"this",g=g.replace(/(@|\$data)([a-zA-Z])/g,"data.$2"),g=g.replace(/(@|\$data)/g,"data"),A){case"foreach":if(g&&"data"!==g?(C=l("{value:"+g+"}",t,o),C=C.value):C=t,j=s.data("bind-foreach-template"),s.empty(),C&&($.isArray(C)||"number"==typeof C.length&&"function"==typeof C.push))for(Array.observe&&(Array.observe(C,n),f=r.data("bind-destroy-funcs"),null==f&&(f=[]),f.push(function(){var e;try{return Array.unobserve(C,n)}catch(a){return e=a,""}}),r.data("bind-destroy-funcs",f)),z=0,B=C.length;B>z;z++)h=C[z],w=j.clone(!0),s.append(w),e.bind(w,h);break;case"text":if(null==t)return;C=null,g&&"data"!==g?(C=l("{value:"+g+"}",t,o),C=C.value):C=t,null==C&&(C=""),m=s.text(),m!==C&&s.text(C);break;case"html":if(null==t)return;C=null,g&&"data"!==g?(C=l("{value:"+g+"}",t,o),C=C.value):C=t,null==C&&(C=""),m=s.text(),m!==C&&s.html(C);break;case"class":u=l(g,t,o);for(b in u)C=u[b],C?s.addClass(b):s.removeClass(b);break;case"style":k=l(g,t,o);for(b in k)x=k[b],y=s.css(b),T=x.replace(/url\(\/(.+)\)/,"url("+location.origin+"$1)"),x!==y&&T!==y&&s.css(b,x);break;case"attr":s.attr(l(g,t,o));break;case"prop":s.prop(l(g,t,o));break;case"visible":C=null,g&&"data"!==g?(C=l("{value:"+g+"}",t,o),C=C.value):C=t,null==C&&(C=!1),C?s.attr("style",(""+s.attr("style")).replace(/display:([^;]+)/,"")):s.hide();break;case"data":C=null,g&&"data"!==g?(C=l("{value:"+g+"}",t,o),C=C.value):C=t,s.data("data",C);break;case"event":p=l(g,t,o);for(v in p)C=p[v],s.off(""+v+".tempaa"),s.on(""+v+".tempaa",$.proxy(C,t))}})})(),t&&("function"==typeof t.addListener?(t.addListener("change",n),r.data("bind-func",n)):"function"==typeof t.on?(t.on("change",n),r.data("bind-func",n)):Object.observe&&(Object.observe(t,n),r.data("bind-func",n))),r},e.destroy=function(e){var a,t,n,r,o,l,d;if(r=$(e),o=r.data("data"),a=r.data("bind-func"),o&&a&&("function"==typeof o.removeListener?o.removeListener("change",a):"function"==typeof o.off?o.off("change",a):Object.unobserve&&Object.unobserve(o,a)),n=r.data("bind-destroy-funcs"))for(l=0,d=n.length;d>l;l++)(t=n[l])();return r.data("data",null),r.data("bind-func",null),r.data("bind-destroy-funcs",null)},e.renderProperties=function(e,a,t){var n,r,o,l,d;if(null==a)return{};l='if (typeof data === "undefined" || data === null) { data = {}; }';for(r in t)l+="var "+r+' = helper["'+r+'"];';for(r in a)d=a[r],l+="function"==typeof d?"var "+r+' = $.proxy(data["'+r+'"], data);':"var "+r+' = data["'+r+'"];';l+="return "+e;try{return o=new Function("data","$","context","helper",l),o.call(this,a,$,a,t)}catch(i){if(n=i,console.error("[Tempaa] render properties error: ",n.message),console.log(a),console.log(l),n.message.match(/is not defined/))for(r in a)d=a[r],"function"!=typeof d&&console.log(r,d);return{}}},e}(),("undefined"!=typeof module&&null!==module?module.exports:void 0)?module.exports=e:"undefined"!=typeof a&&null!==a?a=e:"undefined"!=typeof window&&null!==window&&(window.Tempaa=e)}).call(this);