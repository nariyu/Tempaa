(function(){"use strict";var e,a;e=function(){function e(){}return e.selectorTypes=["foreach","text","html","class","style","attr","visible","data","event"],e.bind=function(a,t){var n,r,o,i,l,d,c,s,u,f,p,h;if(i=$(a),l=this.helper,null==l&&(l=this),d=i.data("data"),r=i.data("bind-func"),d){try{if(_.isEqual(JSON.parse(JSON.stringify(d)),JSON.parse(JSON.stringify(t))))return}catch(b){o=b}r&&(Object.unobserve?Object.unobserve(d,r):"function"==typeof d.removeListener?d.removeListener("change",r):"function"==typeof d.off&&d.off("change",r))}for(i.data("data",t),i.data("bind-func",null),t?i.attr("data-bind-has-data","true"):i.removeAttr("data-bind-has-data"),c=function(e,a){var t,n,r,i;if(null==a)return{};r='if (typeof data === "undefined" || data === null) { data = {}; }';for(t in l)r+="var "+t+' = helper["'+t+'"];';for(t in a)i=a[t],r+="function"==typeof i?"var "+t+' = $.proxy(data["'+t+'"], data);':"var "+t+' = data["'+t+'"];';r+="return "+e;try{return n=new Function("data","$","context","helper",r),n.call(this,a,$,a,l)}catch(d){if(o=d,console.error("[Tempaa] render properties error: ",o.message),console.log(a),console.log(r),o.message.match(/is not defined/))for(t in a)i=a[t],"function"!=typeof i&&console.log(t,i);return{}}},f=["*[data-bind]"],u=this.selectorTypes,p=0,h=u.length;h>p;p++)s=u[p],f.push("*[data-bind-"+s+"]");return(n=function(){var a,n;return a=i.find(f.join(",")),i.is(f.join(","))&&(a=$([i].concat(a.get()))),n=[],a.each(function(){return function(e,a){var t,r,o;return t=$(a),o=t.parent().closest('*[data-bind^="foreach"],*[data-bind-foreach]').get(),r=i.find('*[data-bind^="foreach"],*[data-bind-foreach]').get(),o=$(_.intersection(r,o)),o.length>0&&n.push(a),o.each(function(e,a){var t,n,r,o;return t=$(a),n=t.data("bind-foreach-template"),n||(r=t.attr("data-bind-template-selector"),"string"==typeof r?(n=$(r),o=n.data("bind-foreach-template"),o&&(n=o)):n=t.children(),t.data("bind-foreach-template",n)),t.empty()})}}(this)),a=i.find(f.join(",")),i.is(f.join(","))&&(a=$([i].concat(a.get()))),a.each(function(){return function(a,n){var r,o,i,l,d,f,p,h,b,v,y,m,g,x,j,k,w,O,A,J,L,N,S,T,q,z,C;for(i=$(n),A=[],N=0,q=u.length;q>N;N++)s=u[N],i.is("*[data-bind-"+s+"]")&&(m=i.attr("data-bind-"+s),A.push({type:s,source:m}));for(i.is("*[data-bind]")&&(o=i.attr("data-bind"),"string"==typeof o&&(h=o.match(/^([a-zA-Z]+)(?:\:(.*))?$/),h&&(r=h[0],w=h[1],m=h[2],A.push({type:w,source:m})))),S=0,z=A.length;z>S;S++)switch(O=A[S],w=O.type,m=O.source,w=w.replace(/^\s+/,"").replace(/\s+$/,""),m=m.replace("&lt;","<").replace("&gt;",">").replace("&quot;",'"').replace("&amp;","&"),m=m?m.replace(/^\s+/,"").replace(/\s+$/,""):"this",m=m.replace(/(@|\$data)([a-zA-Z])/g,"data.$2"),m=m.replace(/(@|\$data)/g,"data"),w){case"foreach":if(m&&"data"!==m?(L=c("{value:"+m+"}",t),L=L.value):L=t,j=i.data("bind-foreach-template"),i.empty(),$.isArray(L)||"number"==typeof(null!=L?L.length:void 0)&&"function"==typeof(null!=L?L.push:void 0))for(T=0,C=L.length;C>T;T++)f=L[T],k=j.clone(!0),e.bind(k,f),i.append(k);break;case"text":if(null==t)return;L=null,m&&"data"!==m?(L=c("{value:"+m+"}",t),L=L.value):L=t,null==L&&(L=""),y=i.text(),y!==L&&i.text(L);break;case"html":if(null==t)return;L=null,m&&"data"!==m?(L=c("{value:"+m+"}",t),L=L.value):L=t,null==L&&(L=""),y=i.text(),y!==L&&i.html(L);break;case"class":l=c(m,t);for(p in l)L=l[p],L?i.addClass(p):i.removeClass(p);break;case"style":x=c(m,t);for(p in x)g=x[p],v=i.css(p),J=g.replace(/url\(\/(.+)\)/,"url("+location.origin+"$1)"),g!==v&&J!==v&&i.css(p,g);break;case"attr":i.attr(c(m,t));break;case"visible":L=null,m&&"data"!==m?(L=c("{value:"+m+"}",t),L=L.value):L=t,null==L&&(L=!1),L?i.attr("style",(""+i.attr("style")).replace(/display:([^;]+)/,"")):i.hide();break;case"data":L=null,m&&"data"!==m?(L=c("{value:"+m+"}",t),L=L.value):L=t,i.data("data",L);break;case"event":d=c(m,t);for(b in d)L=d[b],i.off(""+b+".tempaa"),i.on(""+b+".tempaa",$.proxy(L,t))}}}(this))})(),Object.observe?(Object.observe(t,n),i.data("bind-func",n)):"function"==typeof(null!=t?t.addListener:void 0)?(t.addListener("change",n),i.data("bind-func",n)):"function"==typeof(null!=t?t.on:void 0)&&(t.on("change",n),i.data("bind-func",n)),i},e}(),("undefined"!=typeof module&&null!==module?module.exports:void 0)?module.exports=e:"undefined"!=typeof a&&null!==a?a=e:"undefined"!=typeof window&&null!==window&&(window.Tempaa=e)}).call(this);